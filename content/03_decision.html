
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Decision tree &#8212; Machine Learning for PURSUE</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script type="module">
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";
window.addEventListener("load", () => mermaid.run());
</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/03_decision';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Support Vector Machine" href="04_svm.html" />
    <link rel="prev" title="ML Intro" href="02_MLintro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="00_overview.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/Machine_LOGO.png" class="logo__image only-light" alt="Machine Learning for PURSUE - Home"/>
    <script>document.write(`<img src="../_static/Machine_LOGO.png" class="logo__image only-dark" alt="Machine Learning for PURSUE - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="00_overview.html">
                    <span style="color:maroon"> Overview </span>
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_stat.html">Fundamentals of Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_MLintro.html">ML Intro</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Decision tree</a></li>




<li class="toctree-l1"><a class="reference internal" href="04_svm.html">Support Vector Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_gradient_descent.html">Gradient Descent</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_NN_basic.html">Neural Networks</a></li>



<li class="toctree-l1"><a class="reference internal" href="07_findingPI.html">Finding PI</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_CNN.html">Convolutional Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_further.html">Further Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_MLforHEP.html">ML for HEP</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fcontent/03_decision.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/content/03_decision.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Decision tree</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Decision tree</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concept">Concept</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#import-the-modules-that-will-do-all-the-work">Import the modules that will do all the work</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#import-the-data">Import the data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-data-identifying-missing-data">Missing Data: Identifying Missing Data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-formatting">Data formatting</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#build-a-classification-tree">Build A Classification Tree</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-a-tree-learn">How does a tree “learn”?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">❓ Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tips">Tips</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="decision-tree">
<h1>Decision tree<a class="headerlink" href="#decision-tree" title="Link to this heading">#</a></h1>
<a href="https://colab.research.google.com/github/chattopadhyayA/ml_pursue2025/blob/master/content/04_decision.ipynb" target="_blank">
  <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a><section id="concept">
<h2>Concept<a class="headerlink" href="#concept" title="Link to this heading">#</a></h2>
<p>Decision trees are the simplest possible ML code that we can build. Rather than thinking too much about it, let us jump into the details. There are two type sof decision tree</p>
<p><strong>Classification tree</strong> : Classify people or things into two or more discrete categories. As we have done before</p>
<pre  class="mermaid">
        graph TD
    B[&quot;Do you know about decision trees?&quot;]
    B -- Yes --&gt; C[&quot;Have you implemented decision trees?&quot;]
    C -- Yes --&gt; D[&quot;Do not read&quot;]
    C -- No --&gt; E[&quot;Read&quot;]
    B -- No --&gt; F[&quot;Do you want to learn?&quot;]
    F -- Yes --&gt; G[&quot;Read&quot;]
    F -- No --&gt; H[&quot;Do not read.&quot;]
    </pre><p><strong>Regression Trees</strong> This one tries to predict a continuous value. The following example holds for that</p>
<pre  class="mermaid">
        graph TD
    B{&quot;Is it fiction?&lt;div&gt;(100 books)&quot;}
    B -- Yes --&gt; C{&quot;Is it a mystery novel?&lt;div&gt;(28 books)&quot;}
    C -- Yes --&gt; D[&quot;Mystery Fiction&lt;div&gt;(12 books)&quot;]
    C -- No --&gt; E[&quot;Other Fiction&lt;div&gt;(16 books)&quot;]
    B -- No --&gt; F{&quot;Is it a biography?&lt;div&gt;(72 books)&quot;}
    F -- Yes --&gt; G[&quot;Biography Non-Fiction&lt;div&gt;(50 books)&quot;]
    F -- No --&gt; H[&quot;Other Non-Fiction&lt;div&gt;(22 books)&quot;]
    </pre><p>We see multiple parts in the <em>upside down tree</em> shown above. Here are its main components:</p>
<ul class="simple">
<li><p>Root node or root: The very top node in the tree</p></li>
<li><p>Internal or decision nodes: They have arrows pointing to them and away from them.</p></li>
<li><p>Branches: The arrows are called branches, they might be labelles “yes” or “no”, or can be unlabelled. Usually if there is no label, then if the <em>Node</em> is <em>True</em> you go <em>Left</em> or else you go <em>Right</em>.</p></li>
<li><p>Leaf nodes or leaves: They only have arrows pointing to them and represent the final classification.</p></li>
</ul>
<p>Note that an arrow to the left typically represents <code class="docutils literal notranslate"><span class="pre">True</span></code>, while an arrow to the right represents <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>You can see that classification trees are conceptually simple models. This means that they are highly <strong>interpretable</strong>, something that can be very desireable for a model as it allows us to peer into the inner workings of how the model works instead of having to treat the model as a <strong>black box</strong>.</p>
<p>We will use <strong>scikit-learn</strong> and <strong>Cost Complexity Pruning</strong> to build this <strong>Classification Tree</strong> (below), which uses continuous and categorical data from the <strong><a class="reference external" href="https://archive.ics.uci.edu/ml/index.php">UCI Machine Learning Repository</a></strong> to predict whether or not a patient has <strong><a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Heart+Disease">heart disease</a></strong>:</p>
<figure class="align-center" id="tree">
<a class="reference internal image-reference" href="../_images/tree.png"><img alt="../_images/tree.png" src="../_images/tree.png" style="height: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">“Classification tree”</span><a class="headerlink" href="#tree" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>In this lesson we will be carefull and use the data very carefully</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="import-the-modules-that-will-do-all-the-work">
<h1>Import the modules that will do all the work<a class="headerlink" href="#import-the-modules-that-will-do-all-the-work" title="Link to this heading">#</a></h1>
<p>The very first thing we do is load in a bunch of python modules. Python, itself, just gives us a basic programming language. These modules give us extra functionality to import the data, clean it up and format it, and then build, evaluate and draw the classification tree.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span> <span class="c1"># to load and manipulate data and for One-Hot Encoding</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span> <span class="c1"># to calculate the mean and standard deviation</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span> <span class="c1"># to draw graphs</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.tree</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecisionTreeClassifier</span> <span class="c1"># to build a classification tree</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.tree</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_tree</span> <span class="c1"># to draw a classification tree</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span> <span class="c1"># to split data into training and testing sets</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">cross_val_score</span> <span class="c1"># for cross validation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConfusionMatrixDisplay</span> <span class="c1"># creates and draws a confusion matrix</span>
<span class="c1"># from sklearn.metrics import plot_confusion_matrix # to draw a confusion matrix</span>
</pre></div>
</div>
</div>
</div>
<p><a id="download-the-data"></a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="import-the-data">
<h1>Import the data<a class="headerlink" href="#import-the-data" title="Link to this heading">#</a></h1>
<p>Now we load in a dataset from the <strong><a class="reference external" href="https://archive.ics.uci.edu/ml/index.php">UCI Machine Learning Repository</a></strong>.
Specifically, we are going to use the <strong><a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Heart+Disease">Heart Disease Dataset</a></strong>. This dataset will allow us to predict if someone has heart disease based on their sex, age, blood pressure and a variety of other metrics.</p>
<p>When <strong>pandas</strong> (<strong>pd</strong>) reads in data, it returns a <strong>dataframe</strong>, which is a lot like a spreadsheet. The data are organized in rows and columns and each row can contain a mixture of text and numbers. The standard variable name for a <strong>dataframe</strong> is the initials <strong>df</strong>, and that is what we will use here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://archive.ics.uci.edu/ml/machine-learning-databases/heart-disease/processed.cleveland.data&quot;</span>

<span class="c1"># Load the dataset, specifying that &#39;?&#39; denotes missing values</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>

<span class="c1">## print the first 5 rows</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>145.0</td>
      <td>233.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>150.0</td>
      <td>0.0</td>
      <td>2.3</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>67.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>160.0</td>
      <td>286.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>108.0</td>
      <td>1.0</td>
      <td>1.5</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>67.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>120.0</td>
      <td>229.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>129.0</td>
      <td>1.0</td>
      <td>2.6</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>37.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>130.0</td>
      <td>250.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>187.0</td>
      <td>0.0</td>
      <td>3.5</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>130.0</td>
      <td>204.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>172.0</td>
      <td>0.0</td>
      <td>1.4</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We see that instead of nice column names, we just have column numbers.  Since nice column names would make it easier to know how to format the data, let’s replace the column numbers with the following column names:</p>
<ul class="simple">
<li><p><strong>age</strong>,</p></li>
<li><p><strong>sex</strong>,</p></li>
<li><p><strong>cp</strong>, chest pain</p></li>
<li><p><strong>restbp</strong>, resting blood pressure (in mm Hg)</p></li>
<li><p><strong>chol</strong>, serum cholesterol in mg/dl</p></li>
<li><p><strong>fbs</strong>, fasting blood sugar</p></li>
<li><p><strong>restecg</strong>, resting electrocardiographic results</p></li>
<li><p><strong>thalach</strong>,  maximum heart rate achieved</p></li>
<li><p><strong>exang</strong>, exercise induced angina</p></li>
<li><p><strong>oldpeak</strong>, ST depression induced by exercise relative to rest</p></li>
<li><p><strong>slope</strong>, the slope of the peak exercise ST segment.</p></li>
<li><p><strong>ca</strong>, number of major vessels (0-3) colored by fluoroscopy</p></li>
<li><p><strong>thal</strong>, this is short of thalium heart scan.</p></li>
<li><p><strong>hd</strong>, diagnosis of heart disease, the predicted attribute</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## change the column numbers to column names</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;sex&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;cp&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;restbp&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;chol&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;fbs&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;restecg&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;thalach&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;exang&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;oldpeak&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;slope&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;ca&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;thal&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;hd&#39;</span><span class="p">]</span>
<span class="c1">## print the first 5 rows (including the column names)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>restbp</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>hd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>145.0</td>
      <td>233.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>150.0</td>
      <td>0.0</td>
      <td>2.3</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>67.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>160.0</td>
      <td>286.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>108.0</td>
      <td>1.0</td>
      <td>1.5</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>67.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>120.0</td>
      <td>229.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>129.0</td>
      <td>1.0</td>
      <td>2.6</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>37.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>130.0</td>
      <td>250.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>187.0</td>
      <td>0.0</td>
      <td>3.5</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>130.0</td>
      <td>204.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>172.0</td>
      <td>0.0</td>
      <td>1.4</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="missing-data-identifying-missing-data">
<h1>Missing Data: Identifying Missing Data<a class="headerlink" href="#missing-data-identifying-missing-data" title="Link to this heading">#</a></h1>
<p>Unfortunately, the biggest part of any data analysis project is making sure that the data is correctly formatted and fixing it when it is not. The first part of this process is identifying and dealing with <strong>Missing Data</strong>.</p>
<p><strong>Missing Data</strong> is simply a blank space, or a surrogate value like <strong>NA</strong>, that indicates that we failed to collect data for one of the features.</p>
<p>There are two main ways to deal with missing data:</p>
<ol class="arabic simple">
<li><p>We can remove the rows that contain missing data from the dataset. This is relatively easy to do, but it wastes all of the other values that we collected. How a big of a waste this is depends on how important this missing value is for classification. For example, if we are missing a value for <strong>age</strong>, and <strong>age</strong> is not useful for classifying if people have heart disease or not, then it would be a shame to throw out all of someone’s data just because we do not have their <strong>age</strong>.</p></li>
<li><p>We can <strong>impute</strong> the values that are missing. Ii is just a fancy way of saying “we can make an educated guess about about what the value should be”. Continuing our example where we are missing a value for <strong>age</strong>, instead of throwing out the entire row of data, we can fill the missing value with the average age or the median age, or use some other, more sophisticated approach, to guess at an appropriate value.</p></li>
</ol>
<p>In this section, we’ll focus on identifying missing values in the dataset.</p>
<p>First, let’s see what sort of data is in each column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>age        float64
sex        float64
cp         float64
restbp     float64
chol       float64
fbs        float64
restecg    float64
thalach    float64
exang      float64
oldpeak    float64
slope      float64
ca         float64
thal       float64
hd           int64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>We see that that they are almost all <code class="docutils literal notranslate"><span class="pre">float64</span></code>, however, two columns, <strong>ca</strong> and <strong>thal</strong>, have the <code class="docutils literal notranslate"><span class="pre">object</span></code> type and one column, <strong>hd</strong> has <code class="docutils literal notranslate"><span class="pre">int64</span></code>.</p>
<p>The fact that the <strong>ca</strong> and <strong>thal</strong> columns have <code class="docutils literal notranslate"><span class="pre">object</span></code> data types suggests there is something weird going on in them. <code class="docutils literal notranslate"><span class="pre">object</span></code> datatypes are used when there are mixtures of things, like a mixture of numbers and letters. In theory, both <strong>ca</strong> and <strong>thal</strong> should just have a few values representing different categories, so let’s investigate what’s going on by printing out their unique values. We’ll start with <strong>ca</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## print out unique values in the column called &#39;ca&#39;</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.,  3.,  2.,  1., nan])
</pre></div>
</div>
</div>
</div>
<p>We see that <strong>ca</strong> contains numbers (0.0, 3.0, 2.0 and 1.0) and nan(not a number). The numbers represent the number of blood vessels that we lit up by fluoroscopy and the question marks represent missing data.</p>
<p>Now let’s look at the unique values in <strong>thal</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## print out unique values in the column called &#39;thal&#39;</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;thal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 6.,  3.,  7., nan])
</pre></div>
</div>
</div>
</div>
<p>Since scikit-learn’s classification trees do not support datasets with missing values, we need to figure out what to do these question marks. We can either delete these patients from the training dataset, or impute values for the missing data. First let’s see how many rows contain missing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_rows</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">])</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;thal&#39;</span><span class="p">])]</span>

<span class="c1"># Check how many such rows exist</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_rows</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## print out the rows that contain missing values.</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">])</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;thal&#39;</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>restbp</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>hd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>87</th>
      <td>53.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>128.0</td>
      <td>216.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>115.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>166</th>
      <td>52.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>138.0</td>
      <td>223.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>169.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>192</th>
      <td>43.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>132.0</td>
      <td>247.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>143.0</td>
      <td>1.0</td>
      <td>0.1</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>266</th>
      <td>52.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>128.0</td>
      <td>204.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>156.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>287</th>
      <td>58.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>125.0</td>
      <td>220.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>144.0</td>
      <td>0.0</td>
      <td>0.4</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>302</th>
      <td>38.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>138.0</td>
      <td>175.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>173.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now let’s count the number of rows in the full dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>303
</pre></div>
</div>
</div>
</div>
<p>So 6 of the <strong>303</strong> rows, or <strong>2%</strong>, contain missing values. Since <strong>303 - 6 = 297</strong>, and <strong>297</strong> is plenty of data to build a classification tree, we will remove the rows with missing values, rather than try to impute their values.</p>
<p><strong>NOTE:</strong> Imputing missing values is a big topic that we will tackle in another webinar. By taking the “easy” route by just deleting rows with missing values, we can stay focused on <strong>Decision Trees</strong>.</p>
<p>We remove the rows with missing values by selecting all of the rows that <em>do not</em> contain question marks in either the <strong>ca</strong> or <strong>thal</strong> columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## save a new dataframe called &quot;df_no_missing&quot;</span>
<span class="n">df_no_missing</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;thal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Verify that now we do not have anything missing inside df_no_missing</strong></p>
<section id="data-formatting">
<h2>Data formatting<a class="headerlink" href="#data-formatting" title="Link to this heading">#</a></h2>
<p>Now we have no missing elements in the data, so we can format it like we need it. Here we will make “hd” as the target space (Y) and rest of the data as X.</p>
<p>In the code below we are using <code class="docutils literal notranslate"><span class="pre">copy()</span></code> to copy the data <em>by value</em>. By default, pandas uses copy <em>by reference</em>. Using <code class="docutils literal notranslate"><span class="pre">copy()</span></code> ensures that the original data <code class="docutils literal notranslate"><span class="pre">df_no_missing</span></code> is not modified when we modify <code class="docutils literal notranslate"><span class="pre">X</span></code> or <code class="docutils literal notranslate"><span class="pre">y</span></code>. In other words, if we make a mistake when we are formatting the columns for classification trees, we can just re-copy <code class="docutils literal notranslate"><span class="pre">df_no_missing</span></code>, rather than reload the original data and remove the missing values etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Make a new copy of the columns used to make predictions</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_no_missing</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;hd&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># alternatively: X = df_no_missing.iloc[:,:-1]</span>
<span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>restbp</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>145.0</td>
      <td>233.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>150.0</td>
      <td>0.0</td>
      <td>2.3</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>67.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>160.0</td>
      <td>286.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>108.0</td>
      <td>1.0</td>
      <td>1.5</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>67.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>120.0</td>
      <td>229.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>129.0</td>
      <td>1.0</td>
      <td>2.6</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>37.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>130.0</td>
      <td>250.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>187.0</td>
      <td>0.0</td>
      <td>3.5</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>130.0</td>
      <td>204.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>172.0</td>
      <td>0.0</td>
      <td>1.4</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Make a new copy of the column of data we want to predict</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_no_missing</span><span class="p">[</span><span class="s1">&#39;hd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0
1    2
2    1
3    0
4    0
Name: hd, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Now that we have created <strong>X</strong>, which has the data we want to use to make predictions, and <strong>y</strong>, which has the data we want to predict, we are ready to continue formatting <strong>X</strong> so that it is suitable for making a <strong>Decision Tree</strong>.</p>
<p>Now that we have split the dataframe into two pieces, <code class="docutils literal notranslate"><span class="pre">X</span></code>, which contains the data we will use to  predict classifications, and <code class="docutils literal notranslate"><span class="pre">y</span></code>, which contains the known classifications in our training dataset, we need to take a closer look at the variables in <code class="docutils literal notranslate"><span class="pre">X</span></code>. The list bellow tells us what each variable represents and the type of data (<strong>float</strong> or <strong>categorical</strong>) it should contain:</p>
<ul class="simple">
<li><p><strong>age</strong>, <strong>Float</strong></p></li>
<li><p><strong>sex</strong> - <strong>Category</strong></p>
<ul>
<li><p>0 = female</p></li>
<li><p>1 = male</p></li>
</ul>
</li>
<li><p><strong>cp</strong>, chest pain, <strong>Category</strong></p>
<ul>
<li><p>1 = typical angina</p></li>
<li><p>2 = atypical angina</p></li>
<li><p>3 = non-anginal pain</p></li>
<li><p>4 = asymptomatic</p></li>
</ul>
</li>
<li><p><strong>restbp</strong>, resting blood pressure (in mm Hg), <strong>Float</strong></p></li>
<li><p><strong>chol</strong>, serum cholesterol in mg/dl, <strong>Float</strong></p></li>
<li><p><strong>fbs</strong>, fasting blood sugar, <strong>Category</strong></p>
<ul>
<li><p>0 = &gt;=120 mg/dl</p></li>
<li><p>1 = &lt;120 mg/dl</p></li>
</ul>
</li>
<li><p><strong>restecg</strong>, resting electrocardiographic results, <strong>Category</strong></p>
<ul>
<li><p>1 = normal</p></li>
<li><p>2 = having ST-T wave abnormality</p></li>
<li><p>3 = showing probable or definite left ventricular hypertrophy</p></li>
</ul>
</li>
<li><p><strong>thalach</strong>,  maximum heart rate achieved, <strong>Float</strong></p></li>
<li><p><strong>exang</strong>, exercise induced angina, <strong>Category</strong></p>
<ul>
<li><p>0 = no</p></li>
<li><p>1 = yes</p></li>
</ul>
</li>
<li><p><strong>oldpeak</strong>, ST depression induced by exercise relative to rest. <strong>Float</strong></p></li>
<li><p><strong>slope</strong>, the slope of the peak exercise ST segment, <strong>Category</strong></p>
<ul>
<li><p>1 = upsloping</p></li>
<li><p>2 = flat</p></li>
<li><p>3 = downsloping</p></li>
</ul>
</li>
<li><p><strong>ca</strong>, number of major vessels (0-3) colored by fluoroscopy, <strong>Float</strong></p></li>
<li><p><strong>thal</strong>, thalium heart scan, <strong>Category</strong></p>
<ul>
<li><p>3 = normal (no cold spots)</p></li>
<li><p>6 = fixed defect (cold spots during rest and exercise)</p></li>
<li><p>7 = reversible defect (when cold spots only appear during exercise)</p></li>
</ul>
</li>
</ul>
<p>Now, just to review, let’s look at the data types in <code class="docutils literal notranslate"><span class="pre">X</span></code> to remember how python is seeing the data right now.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>age        float64
sex        float64
cp         float64
restbp     float64
chol       float64
fbs        float64
restecg    float64
thalach    float64
exang      float64
oldpeak    float64
slope      float64
ca         float64
thal       float64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>So, we see that <strong>age</strong>, <strong>restbp</strong>, <strong>chol</strong> and <strong>thalach</strong> are all <code class="docutils literal notranslate"><span class="pre">float64</span></code>, which is good, because we want them to be floating point numbers. All of the other columns, however, need to be inspected to make sure they only contain reasonable values, and some of them need to change. This is because, while <strong>scikit learn Decision Trees</strong> natively support continuous data, like resting blood preasure (<strong>restbp</strong>) and maximum heart rate (<strong>thalach</strong>), they do not natively support categorical data, like chest pain (<strong>cp</strong>), which contains 4 different categories. Thus, in order to use categorical data with <strong>scikit learn Decision Trees</strong>, we have to use a trick that converts a column of categorical data into multiple columns of binary values. This trick is called <strong>One-Hot Encoding</strong>.</p>
<p>At this point you may be wondering, “what’s wrong with treating categorical data like continuous data?” To answer that question, let’s look at an example: For the <strong>cp</strong> (chest pain) column, we have 4 options:</p>
<ol class="arabic simple">
<li><p>typical angina</p></li>
<li><p>atypical angina</p></li>
<li><p>non-anginal pain</p></li>
<li><p>asymptomatic</p></li>
</ol>
<p>If we treated these values, 1, 2, 3 and 4, like continuous data, then we would assume that 4, which means “asymptomatic”, is more similar to 3, which means “non-anginal pain”, than it is to 1 or 2, which are other types of chest pain. That means the decision tree would be more likely to cluster the patients with 4s and 3s together than the patients with 4s and 1s together. In contrast, if we treat these numbers like categorical data, then we treat each one as a separate category that is no more or less similar to any of the other categories. Thus, the likelihood of clustering patients with 4s with 3s is the same as clustering 4s with 1s, and that approach is more reasonable.</p>
<p>Now let’s inspect and, if needed, convert the columns that contain categorical and integer data into the correct datatypes. We’ll start with <strong>cp</strong> (chest pain) by inspecting all of its unique values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">[</span><span class="s1">&#39;cp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1., 4., 3., 2.])
</pre></div>
</div>
</div>
</div>
<p><strong>NOTE:</strong> There are many different ways to do <strong>One-Hot Encoding</strong> in Python. Two of the more popular methods are <code class="docutils literal notranslate"><span class="pre">ColumnTransformer()</span></code> (from <strong>scikit-learn</strong>) and <code class="docutils literal notranslate"><span class="pre">get_dummies()</span></code> (from <strong>pandas</strong>), and the both methods have pros and cons. Please investigate using <code class="docutils literal notranslate"><span class="pre">ColumnTransformer()</span></code>, but here we will go with <code class="docutils literal notranslate"><span class="pre">get_dummies()</span></code>.</p>
<p>First, before we commit to converting <strong>cp</strong> with <strong>One-Hot Encoding</strong>, let’s just see what happens when we convert <strong>cp</strong> without saving the results. This will make it easy to see how <code class="docutils literal notranslate"><span class="pre">get_dummies()</span></code> works.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cp&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>restbp</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>cp_1.0</th>
      <th>cp_2.0</th>
      <th>cp_3.0</th>
      <th>cp_4.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63.0</td>
      <td>1.0</td>
      <td>145.0</td>
      <td>233.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>150.0</td>
      <td>0.0</td>
      <td>2.3</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>67.0</td>
      <td>1.0</td>
      <td>160.0</td>
      <td>286.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>108.0</td>
      <td>1.0</td>
      <td>1.5</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>67.0</td>
      <td>1.0</td>
      <td>120.0</td>
      <td>229.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>129.0</td>
      <td>1.0</td>
      <td>2.6</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>37.0</td>
      <td>1.0</td>
      <td>130.0</td>
      <td>250.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>187.0</td>
      <td>0.0</td>
      <td>3.5</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41.0</td>
      <td>0.0</td>
      <td>130.0</td>
      <td>204.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>172.0</td>
      <td>0.0</td>
      <td>1.4</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we can see in the printout above, <code class="docutils literal notranslate"><span class="pre">get_dummies()</span></code> puts all of the columns it does not process in the front and it puts <strong>cp</strong> at the end. It also splits <strong>cp</strong> into <strong>4</strong> columns, just like we expected it. <strong>cp_1.0</strong> is <code class="docutils literal notranslate"><span class="pre">1</span></code> for any patient that scored a <strong>1</strong> for chest pain and <code class="docutils literal notranslate"><span class="pre">0</span></code> for all other patients. <strong>cp_2.0</strong> is <code class="docutils literal notranslate"><span class="pre">1</span></code> for any patient that scored <strong>2</strong> for chest pain and <code class="docutils literal notranslate"><span class="pre">0</span></code> for all other patients. <strong>cp_3.0</strong> is <code class="docutils literal notranslate"><span class="pre">1</span></code> for any patient that scored <strong>3</strong> for chest pain and <strong>cp_4.0</strong> is <code class="docutils literal notranslate"><span class="pre">1</span></code> for any patient that scored <strong>4</strong> for chest pain.</p>
<p>Now that we see how <code class="docutils literal notranslate"><span class="pre">get_dummies()</span></code> works, let’s use it on the four categorical columns that have more than 2 categories and save the result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cp&#39;</span><span class="p">,</span> 
                                       <span class="s1">&#39;restecg&#39;</span><span class="p">,</span> 
                                       <span class="s1">&#39;slope&#39;</span><span class="p">,</span> 
                                       <span class="s1">&#39;thal&#39;</span><span class="p">])</span>
<span class="n">X_encoded</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>restbp</th>
      <th>chol</th>
      <th>fbs</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>ca</th>
      <th>cp_1.0</th>
      <th>...</th>
      <th>cp_4.0</th>
      <th>restecg_0.0</th>
      <th>restecg_1.0</th>
      <th>restecg_2.0</th>
      <th>slope_1.0</th>
      <th>slope_2.0</th>
      <th>slope_3.0</th>
      <th>thal_3.0</th>
      <th>thal_6.0</th>
      <th>thal_7.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63.0</td>
      <td>1.0</td>
      <td>145.0</td>
      <td>233.0</td>
      <td>1.0</td>
      <td>150.0</td>
      <td>0.0</td>
      <td>2.3</td>
      <td>0.0</td>
      <td>True</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>67.0</td>
      <td>1.0</td>
      <td>160.0</td>
      <td>286.0</td>
      <td>0.0</td>
      <td>108.0</td>
      <td>1.0</td>
      <td>1.5</td>
      <td>3.0</td>
      <td>False</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>67.0</td>
      <td>1.0</td>
      <td>120.0</td>
      <td>229.0</td>
      <td>0.0</td>
      <td>129.0</td>
      <td>1.0</td>
      <td>2.6</td>
      <td>2.0</td>
      <td>False</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>37.0</td>
      <td>1.0</td>
      <td>130.0</td>
      <td>250.0</td>
      <td>0.0</td>
      <td>187.0</td>
      <td>0.0</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41.0</td>
      <td>0.0</td>
      <td>130.0</td>
      <td>204.0</td>
      <td>0.0</td>
      <td>172.0</td>
      <td>0.0</td>
      <td>1.4</td>
      <td>0.0</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
<p>Now, one last thing before we build a <strong>Classification Tree</strong>.  <code class="docutils literal notranslate"><span class="pre">y</span></code> doesn’t just contain <strong>0</strong>s and <strong>1</strong>s. Instead, it has <strong>5</strong> different levels of heart disease. <strong>0 =</strong> no heart disease and <strong>1-4</strong> are various degrees of heart disease. We can see this with <code class="docutils literal notranslate"><span class="pre">unique()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 2, 1, 3, 4])
</pre></div>
</div>
</div>
</div>
<p>For simplicity here we will be only making a tree that does simple classification and only care if someone has heart disease or not, so we need to convert all numbers <strong>&gt; 0</strong> to <strong>1</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_not_zero_index</span> <span class="o">=</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="c1"># get the index for each non-zero value in y</span>
<span class="n">y</span><span class="p">[</span><span class="n">y_not_zero_index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># set each non-zero value in y to 1</span>
<span class="n">y</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>               <span class="c1"># verify that y only contains 0 and 1.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 1])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="build-a-classification-tree">
<h1>Build A Classification Tree<a class="headerlink" href="#build-a-classification-tree" title="Link to this heading">#</a></h1>
<p>At long last, the data are correctly formatted for making a <strong>Classification Tree</strong>. Now we simply split the data into <strong>training</strong> and <strong>testing</strong> sets and build the tree.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## split the data into training and testing sets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1">## create a decisiont tree and fit it to the training data</span>
<span class="n">clf_dt</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span>
    <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;gini&quot;</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">clf_dt</span> <span class="o">=</span> <span class="n">clf_dt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">))</span>
<span class="n">plot_tree</span><span class="p">(</span><span class="n">clf_dt</span><span class="p">,</span> 
          <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
          <span class="n">rounded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
          <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No HD&quot;</span><span class="p">,</span> <span class="s2">&quot;Yes HD&quot;</span><span class="p">],</span> 
          <span class="n">feature_names</span><span class="o">=</span><span class="n">X_encoded</span><span class="o">.</span><span class="n">columns</span><span class="p">);</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/099392d3a7fb5dcfaa03373a7588adb6b78536f6952daec3aac282d11c9aada3.png" src="../_images/099392d3a7fb5dcfaa03373a7588adb6b78536f6952daec3aac282d11c9aada3.png" />
</div>
</div>
<p>OK, we’ve built a <strong>Classification Tree</strong> for classification. Let’s see how it performs on the <strong>Testing Dataset</strong> by running the <strong>Testing Dataset</strong> down the tree and drawing a <strong>Confusion Matrix</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## plot_confusion_matrix() will run the test data down the tree and draw</span>
<span class="c1">## a confusion matrix.</span>
<span class="n">ConfusionMatrixDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">clf_dt</span><span class="p">,</span> 
                                      <span class="n">X_test</span><span class="p">,</span> 
                                      <span class="n">y_test</span><span class="p">,</span> 
                                      <span class="n">display_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Does not have HD&quot;</span><span class="p">,</span> <span class="s2">&quot;Has HD&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x16b671760&gt;
</pre></div>
</div>
<img alt="../_images/933e104e8a3a1c5581baedd8f42be69c3c2a8059906027fe214aae64d5823ee0.png" src="../_images/933e104e8a3a1c5581baedd8f42be69c3c2a8059906027fe214aae64d5823ee0.png" />
</div>
</div>
<p>In the confusion matrix, we see that of the <strong>34 + 8 = 42</strong> people that did not have <strong>Heart Disease</strong>, <strong>34 (80%)</strong> were correctly classified. And of the <strong>6 + 27 = 33</strong> people that have <strong>Heart Disease</strong>, <strong>27(81)</strong> were correctly classified. Can we do better?  To make sure of that we should analyze the data</p>
<p>We want to see how our model performs. To do this, we can use several common metrics for quantifying the performance of classification models. These metrics help us understand how well our model is making predictions, and each one gives us a different perspective on its strengths and weaknesses.</p>
<ul>
<li><p>Accuracy: Measures the proportion of correct predictions out of all predictions made.</p>
<div class="math notranslate nohighlight">
\[\text{Accuracy} = \frac{\text{Number of correct predictions}}{\text{Total number of predictions}}\]</div>
<ul class="simple">
<li><p>Good for: Balanced datasets where all classes are equally important.</p></li>
<li><p>Limitations: Can be misleading if the dataset is imbalanced (i.e., some classes are much more frequent than others).</p></li>
</ul>
</li>
<li><p>Precision: Measures the ratio of correctly predicted positive observations to the total predicted positives.</p>
<div class="math notranslate nohighlight">
\[\text{Precision} = \frac{\text{TP}}{\text{TP}+\text{FP}}\]</div>
<p>where TP = True Positives, FP = False Positives.</p>
<ul class="simple">
<li><p>Good for: Situations where the cost of a false positive is high (e.g., spam detection, where marking a real email as spam is bad).</p></li>
</ul>
</li>
<li><p>Recall (Sensitivity or True Positive Rate): Measures the ratio of correctly predicted positive observations to all actual positives.</p>
<div class="math notranslate nohighlight">
\[\text{Recall} = \frac{\text{TP}}{\text{TP}+\text{FN}}\]</div>
<p>where FN = False Negatives.</p>
<ul class="simple">
<li><p>Good for: Situations where missing a positive case is costly (e.g., disease screening, where missing a sick patient is worse than a false alarm).</p></li>
</ul>
</li>
<li><p>F1 Score: It is the harmonic mean of precision and recall. It balances the two metrics and is useful when you need a single score that accounts for both false positives and false negatives.</p>
<div class="math notranslate nohighlight">
\[\text{F1 Score} = 2 \cdot \frac{\text{Precision} \cdot \text{Recall}}{\text{Precision} + \text{Recall}}\]</div>
<ul class="simple">
<li><p>Good for: Datasets with class imbalance, or when you want to balance precision and recall.</p></li>
</ul>
</li>
</ul>
<p>Thankfully, <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> offers functions that compute all of these metrics for us, so we don’t have to do much work to compute these.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function for computing accuracy, precision, recall, and F1 score</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_metrics</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper function to compute accuracy, precision, recall, and F1 score at once.&quot;&quot;&quot;</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

    <span class="c1"># Pretty print the metrics</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision: </span><span class="si">{</span><span class="n">precision</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall: </span><span class="si">{</span><span class="n">recall</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1 Score: </span><span class="si">{</span><span class="n">f1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Testing the performance of the model on training data…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Testing model on training sets</span>
<span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">clf_dt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="c1"># Compute metrics for training sets</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training Set Metrics:&quot;</span><span class="p">)</span>
<span class="n">compute_metrics</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training Set Metrics:
Accuracy: 0.8514
Precision: 0.8817
Recall: 0.7885
F1 Score: 0.8325
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select 2 features and binarized target to see decision boundary</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;chol&#39;</span><span class="p">]</span>
<span class="n">X_vis</span> <span class="o">=</span> <span class="n">df_no_missing</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">df_no_missing</span><span class="p">[</span><span class="s1">&#39;hd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y</span><span class="p">[</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Fit a decision tree for two features</span>
<span class="n">clf_vis</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;gini&quot;</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,)</span>
<span class="n">clf_vis</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_vis</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Prepare the meshgrid for decision boundary</span>
<span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">=</span> <span class="n">X_vis</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_vis</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="n">X_vis</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_vis</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
                     <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">clf_vis</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">xx</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yy</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>


<span class="c1"># Plotting</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot decision boundary</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdYlBu</span><span class="p">)</span>

<span class="c1"># Plot original data points</span>
<span class="n">scatter</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_vis</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_vis</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdYlBu</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>

<span class="c1"># Axis labeling</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cholesterol&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Decision Boundary of Heart Disease (Binary Classification)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Colorbar and legend</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Predicted Class&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;No Heart Disease&#39;</span><span class="p">,</span> <span class="s1">&#39;Has Heart Disease&#39;</span><span class="p">]</span>
<span class="n">legend_handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdYlBu</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">legend_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">),</span>
                  <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdYlBu</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">legend_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_handles</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8d0ffc1c65be599b1639f153b4ee2632bb0578e69551834bc3f76a766b1a59a4.png" src="../_images/8d0ffc1c65be599b1639f153b4ee2632bb0578e69551834bc3f76a766b1a59a4.png" />
</div>
</div>
<section id="how-does-a-tree-learn">
<h2>How does a tree “learn”?<a class="headerlink" href="#how-does-a-tree-learn" title="Link to this heading">#</a></h2>
<p>Now we can ask the question, how is the tree getting trained? While at first it might seem somewhat mysterious when you think about it, how the model actually trains is relatively straight forward, and it comes down to a common theme in ML: the minimization/maximization of some metric guiding an iterative training process. Let’s see how a tree is trained to get a understanding.</p>
<p>Remember the notion of gini index that we learned just before. When you start, at the begining you only have the root node, in which all of your data will fall since no split has been made. So Gini index is zero there. In order to determine a split, the training algorithm creates all possible splits using all features and all values of those features as thresholds. This process is repeated for all possible splits, and then the “best” split is chosen by choosing the one has the lowest total Gini impurity.</p>
<section id="exercise">
<h3>❓ Exercise<a class="headerlink" href="#exercise" title="Link to this heading">#</a></h3>
<p><strong>Q7:</strong> Change the depth of the tree and train again. Does more depth means more accuracy??</p>
<details>
<summary>Click to show answer</summary>
<p>Answer: Not necessarily. Check it again.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="o">&lt;/</span><span class="n">details</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="tips">
<h2>Tips<a class="headerlink" href="#tips" title="Link to this heading">#</a></h2>
<p>When you are not taking a tutorial session, and doing serious data analysis for life and death. One good trick is to first visualise the data without even running any ML, look for the features which are already seperated a bit. and only include them in your tree dataset. For example in the below, I have visualised some of the data from the heart disease dataset. Can you try to play around and figure out which of the data are more relevant??? Is there something, that you can automate??</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Select a few relevant features and the target</span>
<span class="n">selected_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;chol&#39;</span><span class="p">,</span> <span class="s1">&#39;thalach&#39;</span><span class="p">,</span> <span class="s1">&#39;oldpeak&#39;</span><span class="p">,</span> <span class="s1">&#39;hd&#39;</span><span class="p">]</span>
<span class="n">df_subset</span> <span class="o">=</span> <span class="n">df_no_missing</span><span class="p">[</span><span class="n">selected_features</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Convert target to binary: 0 = No HD, 1 = Has HD</span>
<span class="n">df_subset</span><span class="p">[</span><span class="s1">&#39;hd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_subset</span><span class="p">[</span><span class="s1">&#39;hd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Plot pairplot with hue based on heart disease</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df_subset</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;hd&#39;</span><span class="p">,</span> <span class="n">diag_kind</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">,</span> <span class="n">corner</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Pairplot of Selected Features (Heart Disease)&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9aae07585d8625293096de3a20988cf001b8e98b096c9bc1821b1c416677c461.png" src="../_images/9aae07585d8625293096de3a20988cf001b8e98b096c9bc1821b1c416677c461.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="02_MLintro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">ML Intro</p>
      </div>
    </a>
    <a class="right-next"
       href="04_svm.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Support Vector Machine</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Decision tree</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concept">Concept</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#import-the-modules-that-will-do-all-the-work">Import the modules that will do all the work</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#import-the-data">Import the data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-data-identifying-missing-data">Missing Data: Identifying Missing Data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-formatting">Data formatting</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#build-a-classification-tree">Build A Classification Tree</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-a-tree-learn">How does a tree “learn”?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">❓ Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tips">Tips</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div><i>From Rivendell to the ends of the Earth, this code is free to all who wander.</i></div>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>